/ poStatus.html의 <script> 내부

// [기존 코드]
/*
google.script.run
  .withSuccessHandler(data => {
    // ... 데이터 처리 ...
  })
  .withFailureHandler(err => {
    // ... 오류 처리 ...
  })
  .getPoStatusDetails(filters);
*/

// [수정 후 코드]
async function fetchPoStatus() {
  const spinner = document.getElementById('loading-spinner');
  spinner.style.display = 'inline-block';

  try {
    // Netlify Function 경로로 fetch 요청을 보냅니다.
    const response = await fetch('/netlify/functions/getPoStatus', {
        method: 'POST', // 필요시 GET, POST 등 메소드 지정
        body: JSON.stringify(filters) // 필터 정보를 body에 담아 전송
    });

    if (!response.ok) { // HTTP 상태 코드로 성공/실패를 명확히 확인
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json(); // 응답을 JSON 형태로 파싱

    if (data.error) {
      showMessage('데이터 조회 오류: ' + data.error, 'error');
      return;
    }
    
    poStatusDataStore = data.results || [];
    // ... 데이터 처리 로직 (이 부분은 동일) ...
    renderPoStatusTable(poStatusDataStore);

  } catch (err) {
    showMessage('서버 통신 오류: ' + err.message, 'error');
  } finally {
    spinner.style.display = 'none';
  }
}
